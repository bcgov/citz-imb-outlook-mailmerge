<!-- Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT License. -->
<!-- This file shows how to design a first-run page that provides a welcome screen to the user about the features of the add-in. -->

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Outlook Mail Merge Add-in</title>

    <!-- Office JavaScript API -->
    <script type="text/javascript" src="https://appsforoffice.microsoft.com/lib/1.1/hosted/office.js"></script>

    <!-- For more information on Fluent UI, visit https://developer.microsoft.com/fluentui#/. -->
    <link
      rel="stylesheet"
      href="https://static2.sharepointonline.com/files/fabric/office-ui-fabric-js/1.4.0/css/fabric.min.css"
    />
    <link
      rel="stylesheet"
      href="https://static2.sharepointonline.com/files/fabric/office-ui-fabric-js/1.4.0/css/fabric.components.min.css"
    />
    <script src="https://static2.sharepointonline.com/files/fabric/office-ui-fabric-js/1.4.0/js/fabric.min.js"></script>

    <!-- Template styles -->
    <link href="taskpane.css" rel="stylesheet" type="text/css" />
  </head>

  <body class="ms-font-m ms-welcome ms-Fabric">
    <section id="sideload-msg" class="ms-welcome__main">
      <h2 class="ms-font-xl">
        Please
        <a
          target="_blank"
          rel="noopener noreferrer"
          href="https://learn.microsoft.com/office/dev/add-ins/testing/test-debug-office-add-ins#sideload-an-office-add-in-for-testing"
          >sideload</a
        >
        your add-in to see app body.
      </h2>
    </section>
    <main id="app-body" class="ms-Grid">
      <div class="ms-Grid-row">
        <div class="ms-Grid-col ms-sm12">
          <h1 class="ms-font-xxl">Outlook Mail Merge Add-in</h1>
          <p class="ms-font-m">
            This add-in allows you to send personalized emails to a list of contacts using a template. You can also
            attach files to the emails.
          </p>
          <p class="ms-font-m">
            To get started, select a contacts file, a template file, and any other attachments you want to include.
          </p>
          <p class="ms-font-m">
            Contacts file first row should contain the column names. The column names should be the same as the merge
            fields in the template. You must include an email column named 'To' in the contacts file. You may also
            include 'CC' and 'BCC' column names.
          </p>
          <p class="ms-font-m">Then click the "Run Mail Merge" button.</p>
        </div>
      </div>
      <div class="ms-Grid-row">
        <div class="ms-Grid-col ms-sm12">
          <h2 class="ms-font-l">Select Files</h2>
          <ul class="ms-List">
            <li class="ms-ListItem">
              <label for="contactsFile" class="ms-Label ms-ListItem-primaryText">Select a contacts file:<span>*</span></label
              >
              <input type="file" id="contactsFile" name="contactsFile" accept=".xlsx" class="ms-TextField-field" />
            </li>
            <li class="ms-ListItem">
              <label for="templateFile" class="ms-Label ms-ListItem-primaryText">Select a template file:<span>*</span></label>
              <input type="file" id="templateFile" name="templateFile" accept=".docx" class="ms-TextField-field" />
            </li>
            <li class="ms-ListItem">
              <label for="attachments" class="ms-Label ms-ListItem-primaryText">Select attachment files:</label>
              <input
                type="file"
                id="attachments"
                name="attachments"
                accept=".pdf"
                multiple
                class="ms-TextField-field"
              />
              <div class="ms-Grid-row">
                <div class="ms-Grid-col ms-sm12"><ul class="ms-List" id="attachmentsList"></ul></div>
              </div>
            </li>
          </ul>
        </div>
      </div>
      <div class="ms-Grid-row">
        <div class="ms-Grid-col ms-sm12">
          <h2 class="ms-font-l">Subject Line</h2>
          <label for="subjectLine" class="ms-Label ms-ListItem-primaryText">enter the subject line:<span>*</span></label>
          <input id="subjectLine" name="subjectLine" class="ms-TextField-field" />
        </div>
      </div>
      <div class="ms-Grid-row">
        <div class="ms-Grid-col ms-sm12">
          <h2 class="ms-font-l">From Email</h2>
          <p class="ms-font-m">this address will also be added to the bcc field</p>
          <label for="userEmail" class="ms-Label ms-ListItem-primaryText">enter the from email address:<span>*</span></label>
          <input id="userEmail" name="userEmail" class="ms-TextField-field" />
        </div>
      </div>
      <div class="ms-Grid-row">
        <div class="ms-Grid-col ms-sm12">
          <h2 class="ms-font-l">Start Mail Merge</h2>
          <p class="ms-font-m">
            Click the button below to run the mail merge. It is disabled until you have filled out all required fields
          </p>
          <p class="ms-font-m">
            The add-in will send an email to each contact in the contacts file using the template file. If you have
            selected attachment files, they will be attached to the emails.
          </p>
          <button class="ms-Button ms-Button--primary is-disabled" id="runMailMerge">
            <span class="ms-Button-label">Start Mail Merge</span>
          </button>
        </div>
      </div>
    </main>
    <script type="text/javascript">
      var ListElements = document.querySelectorAll(".ms-List");
      for (var i = 0; i < ListElements.length; i++) {
        new fabric["List"](ListElements[i]);
      }
      var ListItemElements = document.querySelectorAll(".ms-ListItem");
      for (var i = 0; i < ListItemElements.length; i++) {
        new fabric["ListItem"](ListItemElements[i]);
      }
      var ToggleElements = document.querySelectorAll(".ms-Toggle");
      for (var i = 0; i < ToggleElements.length; i++) {
        new fabric["Toggle"](ToggleElements[i]);
      }
      var ButtonElements = document.querySelectorAll(".ms-Button");
      for (var i = 0; i < ButtonElements.length; i++) {
        new fabric["Button"](ButtonElements[i], function () {
          // Insert Event Here
        });
      }
    </script>
  </body>
</html>
